using HayWeight.Shared.DTOs;
using Microsoft.AspNetCore.Http;
using Microsoft.AspNetCore.Mvc;
using System;
using System.Collections.Generic;
using System.IO;
using System.Linq;
using System.Threading.Tasks;
using Zebra.Sdk.Comm;
using Zebra.Sdk.Printer;
using ZebraPrinters.Dtos;
using ZebraPrinters.Entities;
using ZebraPrinters.Repositories.Contracts;
using ZebraPrinters.Services.Interfaces;

namespace ZebraPrinters.Controllers
{
    [Route("api/[controller]")]
    [ApiController]
    public class HayWeightController : ControllerBase
    {
        private readonly IPrintService printService;
        private readonly IZebraService zebraService;
        public HayWeightController(IPrintService printService, IZebraService zebraService)
        {
            this.printService = printService;
            this.zebraService = zebraService;
        }

        [Route("PrintSecondCategory")]
        [HttpPost]
        public async Task<ActionResult> PrintSecondCategory(LabelSecondCategoryDto labelSecondCategory)
        {
            

            string LabelString = $@" ^XA~TA000~JSN^LT0^MNW^MTT^PON^PMN^LH0,0^JMA^PR5,5~SD15^JUS^LRN^CI28^XZ
                                         ^XA
                                         ^MMT
                                         ^PW799
                                         ^LL1199
                                         ^LS0
                                         ^FO515,888^GFA,10880,10880,34,,:::::::::gS04,::gS06,gS02,:gS03,::::gS038,:gS078,:::gP0FFC79IF8,gN07FFE0F807FFE,gM0FFCI0FJ01FF8,gL0FFK0FL07F8,gK0FEL0FM03F8,gJ0FEL01FN03F,gI07EM01FO07E,gH03FN03FP07C,gG01F8N03EQ0F8,gG07CO07EQ03E,g01EP07ER07C,g0F8P0FES0F,Y03EP01FCS03C,Y0FQ01FCT0F,X03CQ03F8T03C,X0FR07F8U0F,W03CR0FFV03C,W07R01FFW0F,V01ER01FEW038,V078R03FCX0E,V0ES07F8X078,U038S0FF8X01C,U07T0FFg07,T01CS01FEg038,T038S01FCgG0E,T0ET03F8gG07,S01CT07F8K07CT038,S038T07FK03FFCT0E,S0EU07EK07IF8S07,R01CU0FEJ01JFES038,R038U0FCJ03KF8S0C,R07V0FCJ07KFCS07,Q01CU01F8J0MFS038,Q038U01F8I01FFC7IF8R01C,Q07V01FJ01FE007FFCS0E,Q0EV01FJ03FC001FFES03,P01CV01EJ07F8I07FFS018,P038V01EJ0FFJ03FF8S0C,P07W01EJ0FEK0FFCS06,P0EW01EI01FCK07FES03,O01CW01CI03F8K03FFS018,O038W01CI03F8K01FFT0C,O07X01CI07FM0FF8S06,O0EX01CI07EM07FCS03,N01CX01CI0FEM03FES018,N038Y0C001FCM01FET0C,N03g0E001FCM01FFT0E,N06g0E003F8N0FF8S07,N0Cg06007FO07F8S038,M018g07007FO03FCS018,M038g0380FEO03FCT0C,M07gG01C3FEO01FET06,M06gG01IFCP0FET07,M0CgH07FF8P0FFT038,L018gH03FF8P07FT018,L038gH01FFQ03F8T0C,L03gJ03CQ03F8T0E,L06gW01F8T06,L0CgW01FCT03,L0CgQ07F8J0FCT018,K018gP01FFEJ0FCT018,K03gQ01IFJ0FCU0C,K03gR07FFCI07CU06,K06P04gG01FFEI07CM08M06,K0EP046gG07FF80078M04M03,K0CP031R01FM03FFE0078L01N038,J018O01T0IF8L0IF007M02N018,J018P082Q03JFL07FFC0FM04O0C,J03P01S07JFCK01IF9EW0C,J03P0A4R0LFL0JF8O0CM06,J06P012R0LF8K03IFO01N06,J0CQ06R0F07IFEK01FFCO062M03,J0CgJ0C007IFL03EP094M03,I018O078R018I0IFCW01N018,I018O023S08I03FFEgL018,I03gK08J0IFW02O0C,I03gK08J03FF8W034M0E,I06Q08S0CK0FFCV01CN06,I06O0384S04K07FEgL06,I04P04T06K01FFW03N03,I0CO082T03L0FF8V02N03,I0CO08U03L07FCV0408L018,0018O04U018K03FEW014L018,0018O022U0CL0FFW044M0C,003Q08U06L07F8U01O0C,003O01W038K03F8U0104M0C,003P04V01CK01FCW0CM06,006P01W06L0FCV07N06,006O02X038K07EW03M03,004O018V0FFCK07EW0CM03,00CO022U03IFK03FV02N03,00CO02V07IFCJ01FX04L018,018O01CU0JFEK0FX0CL018,018gL0KF8J0FW022L018,018gK01C07FFEJ0FW08N0C,01gL01801IF8I07gL0C,03gL01I03FFEI07gL0C,03gL01J0IFC00FgL04,02O0CV01J07IF81EX06M06,06O01V01J01KF8W03N06,06P04U018J07FFCgN02,06O024P0FCJ08J01FFEg0C8L03,04P04O0JFI0CK0IF8X0104L03,0CY03KF006K03FFEgM03,0CN01P07KFE07L0IF8Y04L03,0CN018O0E01JFC3L03FFCW0108L01,08N012N018001JFBCK01IFX0EM01818O01N038I01JFEL03FFgL01818N07O078J03JFM07CY02L01818X07CK07IF8gL072L01818X07EL0IFEgM04M0C1Y03FL03IF8gK01N0C1O07O03F8L07IFgK023M0C3Y01FEL01IFCgJ07N0C3g0FFM07IFgS0C3O0EP03FCL0JFCgR043P04O01FF8J03KFgR042P04P07FEJ07KFCgQ062O0AQ03FF8I0780JFgQ062gH0IFI0EI0IFCgP066gH03FFE00CI03IFgP066gI07FFC08I01IF8gO066N0278R01IF88I013FFEgO066O048S03IFCI070IFCgN066O048T07JF87E03IFgN066P08U0LFC00IFCgM026gM0KF8007IFW071C38EJ026gN0IF8I05IFCU0638E11CJ036gN04L027IFU071C3038J036gN06L011IFCS03F861C30FI036gN03M087FFES0FF838E21F80034N03Y038L081IF8R0FF31C703F80034N016X01CL040IFER0FC38E187F80034N011Y0EL0203IFR0F8F030E3F80034N014Y0FL0100IFCQ0F9E21C71F80034N02g078L0803FFEQ0FBC70E38F80034gO03CL0401IF8P0FF8E070CF80034gO01EL02007FFCP0FF1C2187F80034gP0F8K01001IFP0FE3870C3F80036gO0FFCL0C00IF8O0FC70E071F80036gN03IFL06003FFCO078E1C638FI036gN07IFCK03I0FFEP01C38E1CJ036O07X0KF8J01C007FF8O03871E06J036gN0KFCK06001FFCO070E3C43J026gN0C07IF8J038007FEO021C70EK026gM01800IFEJ01C003FFg066gM018003IFK07I0FF8Y066gM01J0IFCJ01C007FCY066N01CW018I03IFK0F003FEY066O088W08J0IFCJ03C03FEY062O09X08J03IFK0F83FCY062O0CX08K0IF8J03IF8Y063N01Y04K03FFEK03FFg063gN06L0IF8gM043gN03L03FFCgM043gN03M0FFEgM0C3gN018L03F8X018M0C1gO0EgN01M0C18O06X07P01EgJ0C18N07Y038O07F8T01N0818O09X01EO0FF8U02L01818O08Y0FO0FF8gH01818gO07CN0FF8T0CM01808gN01FFN0FFU06M0180CO038W0IFCM07EV04L01,0CN01CW03JFCgQ03,0CO04W07KFCgH0CM03,04O068V07LFgH018L03,06gM0E007IFEgG038L02,06N01X0CI07IFCY02N06,06gM08J0JFY018M06,03O07EV08J03IFCY03M06,03O022V08K0JFgM04,03O02W08K01IFCW098M0C,01O01W08K043IFX04M0C,018N02W08K020IF8U01O08,018gL0CK0107FFEW02L018,008O01CU0CL081IF8U044L018,00CP08U06L0C07FFCU018L01,00CO01V06L0401IFgI03,004gL03L02007FF8gH03,006P04U038K01003FFES047M02,006O07V01CL0C00IFS02N06,003O04W0EL06003FFCR01N06,003P044U07L03001FFEQ0108M0C,003P08V038K018007FFR084M0C,0018N01W03CL0C001FFCQ0CN08,0018N01W01FL03I0FFEQ02M018,I0CgL0FF8K018003FFP051M018,I0CN02808S03FFEL0E001FF8P0FM03,I06P0C8S07IFCK03I0FFCX03,I06O029T0KFK01C003FFX06,I07gK0KFCK07001FF8M01O06,I03P04T0C07IF8J03C00FFCN04N0C,I018O041R01800IFEK0F007FCN034M0C,I018O082R018003IFK03C07FCO08L018,J0CP04R01J0IFCK0F8FF8V018,J0CQ08Q018I03IFK01IFW03,J06P01S08J0IFCK03FCN02N03,J06gJ08J03IFV01N06,J03P088R08K0IF8U08N06,J03Q084Q04K03FFET084N0C,J018O0502Q06L0IFT082M01C,J018P011Q03L07FFCS082M018,K0CP048Q03L01FFES04N03,K06P08R018L03FCS01CM03,K06P04S0EgG01O06,K03P02S0FP01EN0108N0E,K038gH01F8O07F8M0164N0C,K018gH0FFEO0FF8N084M018,L0CgH0IFCN0FF8N04N038,L0EgH03IFN0FF8N02N03,L06gI0IFCM0FFX06,L03gI03IFM07EX0C,L018gI0IFCgL0C,L01CgI03IFgK018,M0CgJ0IFCgJ03,M06gJ03IFgJ06,M03gK0IF8gI0E,M038gJ03FFEgI0C,M018gK0IF8gG018,N0CgK07FFCgG03,N06gK01IFgG06,N03gL0IFCg0E,N018gK03FFEY01C,N01CgK01IF8X038,O0EgL0IFCX07,O07gL07IFX06,O038gK021FEW01C,O01CgK01g018,P0EgL08Y03,P07Y07CK04Y0E,P038W03FFCJ02X01C,P01CW07IF8I01X038,Q0EW0JFEJ08W07,Q07W0KF8I0CW0E,Q018U01KFEI06V01C,R0EU01E03IF8003V038,R07U03C007FFE001V06,R038T03C001IF0018T01C,R01CT038I07FFC00CT038,S07T038I01IF00CT07,S038S078J07FF80ES01C,S01CS078J03FFE0ES038,T07S078K0IFCFS07,T038R078K03JFR01C,T01ER07M0JFR038,U07R07M07FFER0E,U03CQ07M01FFCQ01C,V0EQ07N07F8Q07,V038P07gG01E,V01EP07gG078,W078O07gG0E,W01EO03g038,X078N038Y0F,X01EN038X03C,Y078M038X0F,Y01EM038W07C,g078L038V01E,g01FL038V078,gG03CK038U03E,gH0F8J038T01F,gH01FJ038T0FC,gI03FI018S0FE,gJ07E0018R07F,gK0FF018Q0FF,gL0FF18O01FF,gM0F98N07FF,gN018OFC,gN0183LFC,gN018,gO0C,:::::gO04,::::gO02,::,:::::::^FS
                                         ^FT693,53^A0R,51,50^FH\^FD{labelSecondCategory.ProductNamePL}^FS
                                         ^FT619,53^A0R,51,50^FH\^FD{labelSecondCategory.ProductNameFR}^FS
                                         ^FT532,53^A0R,62,62^FH\^FD{labelSecondCategory.StockNumber}^FS
                                         ^FT532,289^A0R,62,62^FH\^FD{labelSecondCategory.LotNumber}^FS
                                         ^FT532,223^A0R,62,62^FH\^FD-^FS
                                         ^BY5,3,121^FT355,185^BCR,,N,N
                                         ^FD>:{labelSecondCategory.StockNumber}-{labelSecondCategory.LotNumber}^FS
                                         ^FT218,276^A0R,135,134^FH\^FD{labelSecondCategory.Weight}^FS
                                         ^FT46,245^A0R,68,67^FH\^FD{labelSecondCategory.Date}^FS
                                         ^FT46,700^A0R,68,67^FH\^FD{labelSecondCategory.Time}^FS
                                         ^PQ1,0,1,Y^XZ";

            string filePath = null;
            try
            {
                Printer printer = new Printer();
                printer = await printService.GetPrinterByDepartment("DT");
                Connection connection = new TcpConnection(printer.IpAddress, 9100);
                connection.Open();

                ZebraPrinter zebraPrinter = ZebraPrinterFactory.GetInstance(connection);

                filePath = zebraService.CreateDemoFile(zebraPrinter.PrinterControlLanguage, LabelString);
                zebraPrinter.SendFileContents(filePath);
                connection.Close();
                return Ok();
            }
            catch (Exception ex)
            {
                throw new Exception($" ex.message: {ex.Message}");
            }
            finally
            {
                try
                {
                    
                }
                catch (ConnectionException) { }

                if (filePath != null)
                {
                    try
                    {
                        new FileInfo(filePath).Delete();
                    }
                    catch (Exception) { }
                }
            }
        }

        [Route("PrintSemiProduct")]
        [HttpPost]
        public async Task<ActionResult> PrintSemiProduct(LabelSemiProductDto labelSemiProduct)
        {


            string LabelString = $@"^XA~TA000~JSN^LT0^MNW^MTT^PON^PMN^LH0,0^JMA^PR5,5~SD15^JUS^LRN^CI28^XZ
                                    ^XA
                                    ^MMT
                                    ^PW799
                                    ^LL1199
                                    ^LS0
                                    ^FO515,888^GFA,10880,10880,34,,:::::::::gS04,::gS06,gS02,:gS03,::::gS038,:gS078,:::gP0FFC79IF8,gN07FFE0F807FFE,gM0FFCI0FJ01FF8,gL0FFK0FL07F8,gK0FEL0FM03F8,gJ0FEL01FN03F,gI07EM01FO07E,gH03FN03FP07C,gG01F8N03EQ0F8,gG07CO07EQ03E,g01EP07ER07C,g0F8P0FES0F,Y03EP01FCS03C,Y0FQ01FCT0F,X03CQ03F8T03C,X0FR07F8U0F,W03CR0FFV03C,W07R01FFW0F,V01ER01FEW038,V078R03FCX0E,V0ES07F8X078,U038S0FF8X01C,U07T0FFg07,T01CS01FEg038,T038S01FCgG0E,T0ET03F8gG07,S01CT07F8K07CT038,S038T07FK03FFCT0E,S0EU07EK07IF8S07,R01CU0FEJ01JFES038,R038U0FCJ03KF8S0C,R07V0FCJ07KFCS07,Q01CU01F8J0MFS038,Q038U01F8I01FFC7IF8R01C,Q07V01FJ01FE007FFCS0E,Q0EV01FJ03FC001FFES03,P01CV01EJ07F8I07FFS018,P038V01EJ0FFJ03FF8S0C,P07W01EJ0FEK0FFCS06,P0EW01EI01FCK07FES03,O01CW01CI03F8K03FFS018,O038W01CI03F8K01FFT0C,O07X01CI07FM0FF8S06,O0EX01CI07EM07FCS03,N01CX01CI0FEM03FES018,N038Y0C001FCM01FET0C,N03g0E001FCM01FFT0E,N06g0E003F8N0FF8S07,N0Cg06007FO07F8S038,M018g07007FO03FCS018,M038g0380FEO03FCT0C,M07gG01C3FEO01FET06,M06gG01IFCP0FET07,M0CgH07FF8P0FFT038,L018gH03FF8P07FT018,L038gH01FFQ03F8T0C,L03gJ03CQ03F8T0E,L06gW01F8T06,L0CgW01FCT03,L0CgQ07F8J0FCT018,K018gP01FFEJ0FCT018,K03gQ01IFJ0FCU0C,K03gR07FFCI07CU06,K06P04gG01FFEI07CM08M06,K0EP046gG07FF80078M04M03,K0CP031R01FM03FFE0078L01N038,J018O01T0IF8L0IF007M02N018,J018P082Q03JFL07FFC0FM04O0C,J03P01S07JFCK01IF9EW0C,J03P0A4R0LFL0JF8O0CM06,J06P012R0LF8K03IFO01N06,J0CQ06R0F07IFEK01FFCO062M03,J0CgJ0C007IFL03EP094M03,I018O078R018I0IFCW01N018,I018O023S08I03FFEgL018,I03gK08J0IFW02O0C,I03gK08J03FF8W034M0E,I06Q08S0CK0FFCV01CN06,I06O0384S04K07FEgL06,I04P04T06K01FFW03N03,I0CO082T03L0FF8V02N03,I0CO08U03L07FCV0408L018,0018O04U018K03FEW014L018,0018O022U0CL0FFW044M0C,003Q08U06L07F8U01O0C,003O01W038K03F8U0104M0C,003P04V01CK01FCW0CM06,006P01W06L0FCV07N06,006O02X038K07EW03M03,004O018V0FFCK07EW0CM03,00CO022U03IFK03FV02N03,00CO02V07IFCJ01FX04L018,018O01CU0JFEK0FX0CL018,018gL0KF8J0FW022L018,018gK01C07FFEJ0FW08N0C,01gL01801IF8I07gL0C,03gL01I03FFEI07gL0C,03gL01J0IFC00FgL04,02O0CV01J07IF81EX06M06,06O01V01J01KF8W03N06,06P04U018J07FFCgN02,06O024P0FCJ08J01FFEg0C8L03,04P04O0JFI0CK0IF8X0104L03,0CY03KF006K03FFEgM03,0CN01P07KFE07L0IF8Y04L03,0CN018O0E01JFC3L03FFCW0108L01,08N012N018001JFBCK01IFX0EM01818O01N038I01JFEL03FFgL01818N07O078J03JFM07CY02L01818X07CK07IF8gL072L01818X07EL0IFEgM04M0C1Y03FL03IF8gK01N0C1O07O03F8L07IFgK023M0C3Y01FEL01IFCgJ07N0C3g0FFM07IFgS0C3O0EP03FCL0JFCgR043P04O01FF8J03KFgR042P04P07FEJ07KFCgQ062O0AQ03FF8I0780JFgQ062gH0IFI0EI0IFCgP066gH03FFE00CI03IFgP066gI07FFC08I01IF8gO066N0278R01IF88I013FFEgO066O048S03IFCI070IFCgN066O048T07JF87E03IFgN066P08U0LFC00IFCgM026gM0KF8007IFW071C38EJ026gN0IF8I05IFCU0638E11CJ036gN04L027IFU071C3038J036gN06L011IFCS03F861C30FI036gN03M087FFES0FF838E21F80034N03Y038L081IF8R0FF31C703F80034N016X01CL040IFER0FC38E187F80034N011Y0EL0203IFR0F8F030E3F80034N014Y0FL0100IFCQ0F9E21C71F80034N02g078L0803FFEQ0FBC70E38F80034gO03CL0401IF8P0FF8E070CF80034gO01EL02007FFCP0FF1C2187F80034gP0F8K01001IFP0FE3870C3F80036gO0FFCL0C00IF8O0FC70E071F80036gN03IFL06003FFCO078E1C638FI036gN07IFCK03I0FFEP01C38E1CJ036O07X0KF8J01C007FF8O03871E06J036gN0KFCK06001FFCO070E3C43J026gN0C07IF8J038007FEO021C70EK026gM01800IFEJ01C003FFg066gM018003IFK07I0FF8Y066gM01J0IFCJ01C007FCY066N01CW018I03IFK0F003FEY066O088W08J0IFCJ03C03FEY062O09X08J03IFK0F83FCY062O0CX08K0IF8J03IF8Y063N01Y04K03FFEK03FFg063gN06L0IF8gM043gN03L03FFCgM043gN03M0FFEgM0C3gN018L03F8X018M0C1gO0EgN01M0C18O06X07P01EgJ0C18N07Y038O07F8T01N0818O09X01EO0FF8U02L01818O08Y0FO0FF8gH01818gO07CN0FF8T0CM01808gN01FFN0FFU06M0180CO038W0IFCM07EV04L01,0CN01CW03JFCgQ03,0CO04W07KFCgH0CM03,04O068V07LFgH018L03,06gM0E007IFEgG038L02,06N01X0CI07IFCY02N06,06gM08J0JFY018M06,03O07EV08J03IFCY03M06,03O022V08K0JFgM04,03O02W08K01IFCW098M0C,01O01W08K043IFX04M0C,018N02W08K020IF8U01O08,018gL0CK0107FFEW02L018,008O01CU0CL081IF8U044L018,00CP08U06L0C07FFCU018L01,00CO01V06L0401IFgI03,004gL03L02007FF8gH03,006P04U038K01003FFES047M02,006O07V01CL0C00IFS02N06,003O04W0EL06003FFCR01N06,003P044U07L03001FFEQ0108M0C,003P08V038K018007FFR084M0C,0018N01W03CL0C001FFCQ0CN08,0018N01W01FL03I0FFEQ02M018,I0CgL0FF8K018003FFP051M018,I0CN02808S03FFEL0E001FF8P0FM03,I06P0C8S07IFCK03I0FFCX03,I06O029T0KFK01C003FFX06,I07gK0KFCK07001FF8M01O06,I03P04T0C07IF8J03C00FFCN04N0C,I018O041R01800IFEK0F007FCN034M0C,I018O082R018003IFK03C07FCO08L018,J0CP04R01J0IFCK0F8FF8V018,J0CQ08Q018I03IFK01IFW03,J06P01S08J0IFCK03FCN02N03,J06gJ08J03IFV01N06,J03P088R08K0IF8U08N06,J03Q084Q04K03FFET084N0C,J018O0502Q06L0IFT082M01C,J018P011Q03L07FFCS082M018,K0CP048Q03L01FFES04N03,K06P08R018L03FCS01CM03,K06P04S0EgG01O06,K03P02S0FP01EN0108N0E,K038gH01F8O07F8M0164N0C,K018gH0FFEO0FF8N084M018,L0CgH0IFCN0FF8N04N038,L0EgH03IFN0FF8N02N03,L06gI0IFCM0FFX06,L03gI03IFM07EX0C,L018gI0IFCgL0C,L01CgI03IFgK018,M0CgJ0IFCgJ03,M06gJ03IFgJ06,M03gK0IF8gI0E,M038gJ03FFEgI0C,M018gK0IF8gG018,N0CgK07FFCgG03,N06gK01IFgG06,N03gL0IFCg0E,N018gK03FFEY01C,N01CgK01IF8X038,O0EgL0IFCX07,O07gL07IFX06,O038gK021FEW01C,O01CgK01g018,P0EgL08Y03,P07Y07CK04Y0E,P038W03FFCJ02X01C,P01CW07IF8I01X038,Q0EW0JFEJ08W07,Q07W0KF8I0CW0E,Q018U01KFEI06V01C,R0EU01E03IF8003V038,R07U03C007FFE001V06,R038T03C001IF0018T01C,R01CT038I07FFC00CT038,S07T038I01IF00CT07,S038S078J07FF80ES01C,S01CS078J03FFE0ES038,T07S078K0IFCFS07,T038R078K03JFR01C,T01ER07M0JFR038,U07R07M07FFER0E,U03CQ07M01FFCQ01C,V0EQ07N07F8Q07,V038P07gG01E,V01EP07gG078,W078O07gG0E,W01EO03g038,X078N038Y0F,X01EN038X03C,Y078M038X0F,Y01EM038W07C,g078L038V01E,g01FL038V078,gG03CK038U03E,gH0F8J038T01F,gH01FJ038T0FC,gI03FI018S0FE,gJ07E0018R07F,gK0FF018Q0FF,gL0FF18O01FF,gM0F98N07FF,gN018OFC,gN0183LFC,gN018,gO0C,:::::gO04,::::gO02,::,:::::::^FS
                                    ^FT693,53^A0R,51,50^FH\^FD{labelSemiProduct.ProductNamePL}^FS
                                    ^FT619,53^A0R,51,50^FH\^FD{labelSemiProduct.ProductNameFR}^FS
                                    ^FT532,53^A0R,62,62^FH\^FD{labelSemiProduct.StockNumber}^FS
                                    ^FT532,289^A0R,62,62^FH\^FD{labelSemiProduct.LotNumber}^FS
                                    ^FT532,223^A0R,62,62^FH\^FD-^FS
                                    ^FT532,521^A0R,62,62^FH\^FD Nm {labelSemiProduct.Nm}^FS
                                    ^BY5,3,121^FT355,185^BCR,,N,N
                                    ^FD>:{labelSemiProduct.StockNumber}-{labelSemiProduct.LotNumber}-{labelSemiProduct.Nm}^FS
                                    ^FT218,276^A0R,135,134^FH\^FD{labelSemiProduct.Weight}^FS
                                    ^FT46,245^A0R,68,67^FH\^FD{labelSemiProduct.Date}^FS
                                    ^FT46,700^A0R,68,67^FH\^FD{labelSemiProduct.Time}^FS
                                    ^PQ1,0,1,Y^XZ";

            string filePath = null;
            try
            {
                Printer printer = new Printer();
                printer = await printService.GetPrinterByDepartment("DT");
                Connection connection = new TcpConnection(printer.IpAddress, 9100);
                connection.Open();

                ZebraPrinter zebraPrinter = ZebraPrinterFactory.GetInstance(connection);

                filePath = zebraService.CreateDemoFile(zebraPrinter.PrinterControlLanguage, LabelString);
                zebraPrinter.SendFileContents(filePath);
                connection.Close();
                return Ok();
            }
            catch (Exception ex)
            {
                throw new Exception($" ex.message: {ex.Message}");
            }
            finally
            {
                try
                {
                    
                }
                catch (ConnectionException) { }

                if (filePath != null)
                {
                    try
                    {
                        new FileInfo(filePath).Delete();
                    }
                    catch (Exception) { }
                }
            }
        }


    }
}
